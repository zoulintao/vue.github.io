import{a as p,s as X}from"./subject-Cc2gGWrX.js";import{_ as Y,r as _,a as V,c as H,d as l,w as r,b as y,u as J,e as d,f as K,i as D,h as I,E as c,p as Q}from"./index-zbuosgjY.js";import{s as W,u as Z}from"./staffApi-CZydvpWR.js";import{g as ee}from"./information-D-eBBSQO.js";const le={class:"info_box"},te={class:"img_box"},ae=["src"],oe={__name:"InformationInput",setup(re){const U=ee(),q=J(),i=_([]),x=_(""),g=_(!1),C=(n,e)=>{console.log(n,e)},E=n=>{x.value=n.url,g.value=!0},j=V({options:p.regionData,selectedOptions:["110000","110100","110101"]}),f=_(),F=n=>{let e=new Date(n),a=e.getFullYear(),s=e.getMonth()+1;s=s<10?"0"+s:s;let u=e.getDate();return u=u<10?"0"+u:u,a+"-"+s+"-"+u},t=V({name:"",sex:"",age:0,ID_card_number:"",telephone_number:"",address:"",department:"",subject:[],teacher_level:"",date:""}),k=(n,e,a)=>{e<18?a(new Error("年龄必须大于18岁")):a()},T=(n,e,a)=>{e===""?a(new Error("请输入身份证号码")):new RegExp(/^\d{6}((((((19|20)\d{2})(0[13-9]|1[012])(0[1-9]|[12]\d|30))|(((19|20)\d{2})(0[13578]|1[02])31)|((19|20)\d{2})02(0[1-9]|1\d|2[0-8])|((((19|20)([13579][26]|[2468][048]|0[48]))|(2000))0229))\d{3})|((((\d{2})(0[13-9]|1[012])(0[1-9]|[12]\d|30))|((\d{2})(0[13578]|1[02])31)|((\d{2})02(0[1-9]|1\d|2[0-8]))|(([13579][26]|[2468][048]|0[048])0229))\d{2}))(\d|X|x)$/).test(t.ID_card_number)?a():a(new Error("身份证不符合规则"))},N=(n,e,a)=>{e===""?a(new Error("请输入电话号码")):new RegExp(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/).test(t.telephone_number)?a():a(new Error("电话号码不符合规则"))},R=n=>{t.address=p.CodeToText[n[0]]+p.CodeToText[n[1]]+p.CodeToText[n[2]]},S=V({name:[{required:!0,message:"请输入员工姓名",trigger:"blur"},{min:2,max:5,message:"员工姓名不应该少于两个字符",trigger:"blur"}],age:[{validator:k,required:!0,message:"请输入年龄"},{type:"number",message:"年龄必须是一个数字"}],ID_card_number:[{validator:T,required:!0}],telephone_number:[{validator:N,required:!0}],address:[{required:!0,message:"请选择家庭地址",trigger:"blur"}],subject:[{message:"请选择教授课程",required:!0,trigger:"change"}],department:[{required:!0,message:"请选择员工岗位",trigger:"change"}],teacher_level:[{required:!0,message:"请选择教师级别",trigger:"change"}],date:[{type:"date",required:!0,message:"请选择入职时间",trigger:"change"}],sex:[{required:!0,message:"请选择年龄",trigger:"change"}]}),z=async n=>{t.date=F(t.date);let e="";for(let a=0;a<t.subject.length;a++)e=e+t.subject[a]+"、";e=e.substring(0,e.length-1),t.subject=e,n&&await n.validate((a,s)=>{a?i.value!=""?W(t).then(u=>{u.code===200&&Z(i.value[0].raw,t.ID_card_number).then(b=>{if(b.code===200){c({message:"数据提交成功",type:"success",duration:1500});let v={idNum:t.ID_card_number,grade:t.teacher_level};U.storeGrade(v),q.push({path:"/home/grade"})}else c({message:"数据提交失败！",type:"error",duration:1500})})}):c({message:"请选择证件照！",type:"error",duration:1500}):c({message:"请完善信息",type:"error",duration:1500})})},$=n=>{n&&n.resetFields()};return(n,e)=>{const a=d("el-input"),s=d("el-form-item"),u=d("el-radio"),b=d("el-radio-group"),v=d("el-cascader"),m=d("el-option"),w=d("el-select"),B=d("el-tree-select"),M=d("el-date-picker"),L=d("el-col"),h=d("el-button"),P=d("el-form"),A=d("el-icon"),G=d("el-upload"),O=d("el-dialog");return K(),H("div",le,[l(P,{ref_key:"ruleFormRef",ref:f,model:t,rules:S,"label-width":"120px",class:"demo-ruleForm",size:n.formSize,"status-icon":""},{default:r(()=>[l(s,{label:"职工姓名",prop:"name"},{default:r(()=>[l(a,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o),class:"input"},null,8,["modelValue"])]),_:1}),l(s,{label:"职工性别",prop:"sex"},{default:r(()=>[l(b,{modelValue:t.sex,"onUpdate:modelValue":e[1]||(e[1]=o=>t.sex=o)},{default:r(()=>[l(u,{label:"男"}),l(u,{label:"女"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"年龄",prop:"age"},{default:r(()=>[l(a,{modelValue:t.age,"onUpdate:modelValue":e[2]||(e[2]=o=>t.age=o),modelModifiers:{number:!0},class:"input"},null,8,["modelValue"])]),_:1}),l(s,{label:"身份证号码",prop:"ID_card_number"},{default:r(()=>[l(a,{modelValue:t.ID_card_number,"onUpdate:modelValue":e[3]||(e[3]=o=>t.ID_card_number=o),class:"input"},null,8,["modelValue"])]),_:1}),l(s,{label:"电话号码",prop:"telephone_number"},{default:r(()=>[l(a,{modelValue:t.telephone_number,"onUpdate:modelValue":e[4]||(e[4]=o=>t.telephone_number=o),class:"input"},null,8,["modelValue"])]),_:1}),l(s,{label:"家庭住址",prop:"address"},{default:r(()=>[l(v,{size:"default",options:j.options,onChange:R},null,8,["options"])]),_:1}),l(s,{label:"所属学院",prop:"department"},{default:r(()=>[l(w,{modelValue:t.department,"onUpdate:modelValue":e[5]||(e[5]=o=>t.department=o),placeholder:"请选择学院"},{default:r(()=>[l(m,{label:"智能科技学院",value:"智能科技学院"}),l(m,{label:"体育与健康学院",value:"体育与健康学院"}),l(m,{label:"商学院",value:"商学院"}),l(m,{label:"艺术学院",value:"艺术学院"}),l(m,{label:"人文学院",value:"人文学院"}),l(m,{label:"汽车学院",value:"汽车学院"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"所授课程",prop:"subject"},{default:r(()=>[l(B,{modelValue:t.subject,"onUpdate:modelValue":e[6]||(e[6]=o=>t.subject=o),data:D(X),multiple:"","render-after-expand":!1,"show-checkbox":"","check-strictly":"","check-on-click-node":""},null,8,["modelValue","data"])]),_:1}),l(s,{label:"教师级别",prop:"teacher_level"},{default:r(()=>[l(w,{modelValue:t.teacher_level,"onUpdate:modelValue":e[7]||(e[7]=o=>t.teacher_level=o),placeholder:"级别选择"},{default:r(()=>[l(m,{label:"助教",value:"助教"}),l(m,{label:"讲师",value:"讲师"}),l(m,{label:"副教授",value:"副教授"}),l(m,{label:"教授",value:"教授"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"入职时间",required:""},{default:r(()=>[l(L,{span:11},{default:r(()=>[l(s,{prop:"date"},{default:r(()=>[l(M,{modelValue:t.date,"onUpdate:modelValue":e[8]||(e[8]=o=>t.date=o),type:"date",label:"入职时间",placeholder:"请选择入职时间",style:{"min-width":"214px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(s,{class:"btn_box"},{default:r(()=>[l(h,{type:"primary",onClick:e[9]||(e[9]=o=>z(f.value))},{default:r(()=>e[13]||(e[13]=[I("提交")])),_:1}),l(h,{onClick:e[10]||(e[10]=o=>$(f.value))},{default:r(()=>e[14]||(e[14]=[I("重置")])),_:1})]),_:1})]),_:1},8,["model","rules","size"]),y("div",te,[l(G,{"file-list":i.value,"onUpdate:fileList":e[11]||(e[11]=o=>i.value=o),action:"#","list-type":"picture-card",name:"avatar",headers:"multipart/form-data",accept:"image/*","on-preview":E,"auto-upload":!1,"on-remove":C,limit:"1"},{default:r(()=>[l(A,null,{default:r(()=>[l(D(Q))]),_:1})]),_:1},8,["file-list"]),l(O,{modelValue:g.value,"onUpdate:modelValue":e[12]||(e[12]=o=>g.value=o)},{default:r(()=>[y("img",{"w-full":"",src:x.value,alt:"选择图片"},null,8,ae)]),_:1},8,["modelValue"])])])}}},me=Y(oe,[["__scopeId","data-v-0acd2888"]]);export{me as default};
