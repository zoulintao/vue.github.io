import{a as p,s as O}from"./subject-Cc2gGWrX.js";import{_ as $,l as A,r as h,a as f,o as B,c as X,d as t,w as r,u as Y,e as u,f as G,i as H,h as x,n as J,E as w}from"./index-zbuosgjY.js";import{g as K}from"./information-D-eBBSQO.js";const P={class:"info_box"},Q={__name:"EditDataView",setup(W){const c=Y(),n=A(),b=K(),D=h("default"),_=f({options:p.regionData,selectedOptions:[]}),g=h(),L=a=>{let e=new Date(a),d=e.getFullYear(),o=e.getMonth()+1;o=o<10?"0"+o:o;let i=e.getDate();return i=i<10?"0"+i:i,d+"-"+o+"-"+i};B(()=>{n.getAddress(p.regionData),l.address=n.address,_.selectedOptions=n.address}),console.log("编辑数据：",n.dataList);const l=f({id:n.dataList.id,name:n.dataList.name,sex:n.dataList.sex,age:n.dataList.age,ID_card_num:n.dataList.ID_card_num,telephone_num:n.dataList.telephone_num,department:n.dataList.department,subject:n.dataList.subject,teacher_level:n.dataList.teacher_level,data:n.dataList.data,address:n.dataList.address}),y=(a,e,d)=>{e<18?d(new Error("年龄必须大于18岁")):d()},E=(a,e,d)=>{e===""?d(new Error("请输入身份证号码")):new RegExp(/^\d{6}((((((19|20)\d{2})(0[13-9]|1[012])(0[1-9]|[12]\d|30))|(((19|20)\d{2})(0[13578]|1[02])31)|((19|20)\d{2})02(0[1-9]|1\d|2[0-8])|((((19|20)([13579][26]|[2468][048]|0[48]))|(2000))0229))\d{3})|((((\d{2})(0[13-9]|1[012])(0[1-9]|[12]\d|30))|((\d{2})(0[13578]|1[02])31)|((\d{2})02(0[1-9]|1\d|2[0-8]))|(([13579][26]|[2468][048]|0[048])0229))\d{2}))(\d|X|x)$/).test(l.ID_card_num)?d():d(new Error("身份证不符合规则"))},q=(a,e,d)=>{e===""?d(new Error("请输入电话号码")):new RegExp(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/).test(l.telephone_num)?d():d(new Error("电话号码不符合规则"))},C=a=>{l.address=p.CodeToText[a[0]]+p.CodeToText[a[1]]+p.CodeToText[a[2]],console.log("ruleForm.address",l.address)},U=f({name:[{required:!0,message:"请输入员工姓名",trigger:"blur"},{min:2,max:5,message:"员工姓名不应该少于两个字符",trigger:"blur"}],age:[{validator:y,required:!0,message:"请输入年龄"}],ID_card_number:[{validator:E,required:!0}],telephone_number:[{validator:q,required:!0}],address:[{required:!0,message:"请选择家庭地址",trigger:"blur"}],subject:[{message:"请选择教授课程",required:!0,trigger:"change"}],department:[{required:!0,message:"请选择员工岗位",trigger:"change"}],teacher_level:[{required:!0,message:"请选择教师级别",trigger:"change"}],sex:[{required:!0,message:"请选择年龄",trigger:"change"}]}),j=()=>{let a="";for(let e=0;e<l.subject.length;e++)a=a+l.subject[e]+"、";a=a.substring(0,a.length-2),l.subject=a},F=()=>{l.teacher_level!=n.dataList.teacher_level?(b.idNum=l.ID_card_num,b.grade=l.teacher_level,c.push({path:"/home/grade"})):c.push({path:"/home"})},I=async a=>{l.data=L(l.data),l.address instanceof Array&&(l.address=n.addressName),j(),a&&await a.validate((e,d)=>{e?(console.log(l),J(l).then(o=>{o.code===200&&(w({message:"数据修改成功",type:"success",duration:1500}),F())})):w({message:"请完善信息",type:"error",duration:1500})})},k=a=>{a&&(a.resetFields(),c.push({path:"/home"}))};return(a,e)=>{const d=u("el-input"),o=u("el-form-item"),i=u("el-radio"),T=u("el-radio-group"),N=u("el-cascader"),m=u("el-option"),V=u("el-select"),S=u("el-tree-select"),R=u("el-date-picker"),z=u("el-col"),v=u("el-button"),M=u("el-form");return G(),X("div",P,[t(M,{ref_key:"ruleFormRef",ref:g,model:l,rules:U,"label-width":"120px",class:"demo-ruleForm",size:D.value,"status-icon":""},{default:r(()=>[t(o,{label:"职工姓名",prop:"name"},{default:r(()=>[t(d,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=s=>l.name=s),class:"input"},null,8,["modelValue"])]),_:1}),t(o,{label:"职工性别",prop:"sex"},{default:r(()=>[t(T,{modelValue:l.sex,"onUpdate:modelValue":e[1]||(e[1]=s=>l.sex=s)},{default:r(()=>[t(i,{label:"男"}),t(i,{label:"女"})]),_:1},8,["modelValue"])]),_:1}),t(o,{label:"年龄",prop:"age"},{default:r(()=>[t(d,{modelValue:l.age,"onUpdate:modelValue":e[2]||(e[2]=s=>l.age=s),modelModifiers:{number:!0},class:"input"},null,8,["modelValue"])]),_:1}),t(o,{label:"身份证号码",prop:"ID_card_number"},{default:r(()=>[t(d,{modelValue:l.ID_card_num,"onUpdate:modelValue":e[3]||(e[3]=s=>l.ID_card_num=s),class:"input"},null,8,["modelValue"])]),_:1}),t(o,{label:"电话号码",prop:"telephone_number"},{default:r(()=>[t(d,{modelValue:l.telephone_num,"onUpdate:modelValue":e[4]||(e[4]=s=>l.telephone_num=s),class:"input"},null,8,["modelValue"])]),_:1}),t(o,{label:"家庭住址",prop:"address"},{default:r(()=>[t(N,{size:"default",options:_.options,modelValue:_.selectedOptions,"onUpdate:modelValue":e[5]||(e[5]=s=>_.selectedOptions=s),onChange:C},null,8,["options","modelValue"])]),_:1}),t(o,{label:"所属学院",prop:"department"},{default:r(()=>[t(V,{modelValue:l.department,"onUpdate:modelValue":e[6]||(e[6]=s=>l.department=s),placeholder:"请选择学院"},{default:r(()=>[t(m,{label:"智能科技学院",value:"智能科技学院"}),t(m,{label:"体育与健康学院",value:"体育与健康学院"}),t(m,{label:"商学院",value:"商学院"}),t(m,{label:"艺术学院",value:"艺术学院"}),t(m,{label:"人文学院",value:"人文学院"}),t(m,{label:"汽车学院",value:"汽车学院"})]),_:1},8,["modelValue"])]),_:1}),t(o,{label:"所授课程",prop:"subject",class:"el_tree"},{default:r(()=>[t(S,{modelValue:l.subject,"onUpdate:modelValue":e[7]||(e[7]=s=>l.subject=s),data:H(O),multiple:"","render-after-expand":!1,"show-checkbox":"","check-strictly":"","check-on-click-node":""},null,8,["modelValue","data"])]),_:1}),t(o,{label:"教师职称",prop:"teacher_level"},{default:r(()=>[t(V,{modelValue:l.teacher_level,"onUpdate:modelValue":e[8]||(e[8]=s=>l.teacher_level=s),placeholder:"级别选择"},{default:r(()=>[t(m,{label:"助教",value:"助教"}),t(m,{label:"讲师",value:"讲师"}),t(m,{label:"副教授",value:"副教授"}),t(m,{label:"教授",value:"教授"})]),_:1},8,["modelValue"])]),_:1}),t(o,{label:"入职时间",required:""},{default:r(()=>[t(z,{span:11},{default:r(()=>[t(o,null,{default:r(()=>[t(R,{modelValue:l.data,"onUpdate:modelValue":e[9]||(e[9]=s=>l.data=s),type:"date",label:"入职时间",placeholder:"请选择入职时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(o,null,{default:r(()=>[t(v,{type:"primary",onClick:e[10]||(e[10]=s=>I(g.value))},{default:r(()=>e[12]||(e[12]=[x("修改")])),_:1}),t(v,{onClick:e[11]||(e[11]=s=>k(g.value))},{default:r(()=>e[13]||(e[13]=[x("返回")])),_:1})]),_:1})]),_:1},8,["model","rules","size"])])}}},le=$(Q,[["__scopeId","data-v-6c507431"]]);export{le as default};
